{% extends "webbase.html" %} {% load static %} {% block overlay_content %}

<script>
  document.documentElement.classList.add("loading");
</script>

<div class="Birdpage-firstbox">
  <div class="Bird_namebox">
    <div class="Scientific_name gsap-hidden">
      SCIENTIFIC NAME: {{ bird.Bird_Scientific_Name }}, FAMILY: {{ bird.Bird_Family }}
    </div>
    <div class="Bird_name">
      <span class="inner2 gsap-hidden">{{ bird.Bird_Name }}</span>
    </div>
    <div class="Other_names gsap-hidden">AKA: {{ bird.Bird_AKA }}</div>
  </div>
</div>
<div class="tree-desktop-only1">
  <div class="Bird-basicinfo">
    <div class="Info-titles">
      <div class="Info-title gsap-hidden">LENGTH</div>
      <div class="Info-title gsap-hidden">WINGSPAN</div>
      <div class="Info-title gsap-hidden">WEIGHT</div>
      <div class="Info-title gsap-hidden">LIFESPAN</div>
    </div>
    <div class="Info-details">
      <div class="Info-detail gsap-hidden">{{ bird.Bird_Length }}</div>
      <div class="Info-detail gsap-hidden">{{ bird.Bird_Wingspan }}</div>
      <div class="Info-detail gsap-hidden">{{ bird.Bird_Weight }}</div>
      <div class="Info-detail gsap-hidden">{{ bird.Bird_Lifespan }}</div>
    </div>
    <div class="Info-details-text">
      {% if bird.Bird_Length_Details %}
      <div class="Info-detail-text gsap-hidden">
        {{ bird.Bird_Length_Details }}
      </div>
      {% endif %} {% if bird.Bird_Wingspan_Details %}
      <div class="Info-detail-text gsap-hidden">
        {{ bird.Bird_Wingspan_Details }}
      </div>
      {% endif %} {% if bird.Bird_Weight_Details %}
      <div class="Info-detail-text gsap-hidden">
        {{ bird.Bird_Weight_Details }}
      </div>
      {% endif %} {% if bird.Bird_Lifespan_Details %}
      <div class="Info-detail-text gsap-hidden">
        {{ bird.Bird_Lifespan_Details }}
      </div>
      {% endif %}
    </div>
  </div>
</div>
<div class="tree-tab-mobile-only">
  <div class="Bird-basicinfo-grid">
    <!-- LENGTH -->
    <div class="Info-block">
      <div class="Info-title">LENGTH</div>
      <div class="Info-detail">{{ bird.Bird_Length }}</div>

      {% if bird.Bird_Length_Details %}
      <div class="Info-detail-text">{{ bird.Bird_Length_Details }}</div>
      {% endif %}
    </div>

    <!-- WINGSPAN -->
    <div class="Info-block">
      <div class="Info-title">WINGSPAN</div>
      <div class="Info-detail">{{ bird.Bird_Wingspan }}</div>

      {% if bird.Bird_Wingspan_Details %}
      <div class="Info-detail-text">{{ bird.Bird_Wingspan_Details }}</div>
      {% endif %}
    </div>

    <!-- WEIGHT -->
    <div class="Info-block">
      <div class="Info-title">WEIGHT</div>
      <div class="Info-detail">{{ bird.Bird_Weight }}</div>

      {% if bird.Bird_Weight_Details %}
      <div class="Info-detail-text">{{ bird.Bird_Weight_Details }}</div>
      {% endif %}
    </div>

    <!-- LIFESPAN -->
    <div class="Info-block">
      <div class="Info-title">LIFESPAN</div>
      <div class="Info-detail">{{ bird.Bird_Lifespan }}</div>

      {% if bird.Bird_Lifespan_Details %}
      <div class="Info-detail-text">{{ bird.Bird_Lifespan_Details }}</div>
      {% endif %}
    </div>
  </div>
</div>

<div class="Birdpage-secondbox">

  <div class="Birdpage-secondbox_1 anim-box">
    <div class="birdanimationbox">
      <video muted loop playsinline preload="none" id="birdVideo">
    <source data-src="{{ bird.Bird_Animation.url }}" type="video/mp4" />
</video>
<script>
document.addEventListener("DOMContentLoaded", function () {
    const video = document.getElementById("birdVideo");
    const source = video.querySelector("source");

    if (source && source.dataset.src) {
        source.src = source.dataset.src;
        video.load();

        video.play().catch(() => {
            // autoplay may be blocked until interaction
        });
    }
});
</script>
    </div>
  </div>>
  <div class="media-box">
    <div class="media-boxrow1">
      <!-- Hear Bird Call -->
      {% if bird.Bird_Call %}
      <div class="media-box1 bird-audio-trigger">
        <div class="icon gsap-hidden">
          <img
            class="bird-audio-poster"
            src="{% static 'img/music.png' %}"
            alt="Play sound"
          />
          <video class="bird-audio-video" muted loop playsinline muted
  preload="none">
            <source
              src="{% static 'video/birdcall.webm' %}"
              type="video/webm"
            />
          </video>
        </div>
        <div class="media-head gsap-hidden">Hear Bird Call</div>
      </div>

      <audio id="birdCallAudio" muted
  preload="none">
        <source src="{{ bird.Bird_Call.url }}" type="audio/mpeg" />
      </audio>
      {% endif %}

      <!-- Photo link -->
      {% if bird.Bird_Image1 %}
      <a href="{% url 'bird_gallery' bird.id %}?type=photo" class="media-box1">
        <div class="icon gsap-hidden">
          <img src="{% static 'img/photo.png' %}" alt="View photos" />
        </div>
        <div class="media-head gsap-hidden">See Photo</div>
      </a>
      {% endif %}

      <!-- Video link -->
      {% if bird.Bird_Video %}
      <a href="{% url 'bird_gallery' bird.id %}?type=video" class="media-box1">
        <div class="icon gsap-hidden">
          <img src="{% static 'img/video.png' %}" alt="Watch video" />
        </div>
        <div class="media-head gsap-hidden">Watch Video</div>
      </a>
      {% endif %}
    </div>
    <div class="media-boxrow2">
		<div class="Birdpage-secondbox_1">
		    <div class="Info-title gsap-hidden">LOCAL PRESENCE</div>
    <div class="Info-detail-text6 gsap-hidden">
      {{ bird.BirdAt_HoHStatus }}
    </div></div>
		</div>
  </div>
</div>
<div class="bird-page-girl hide-on-mobile">
<img src="{% static 'img/birdpage-bg.webp' %}">
</div>

<script>
document.addEventListener("DOMContentLoaded", () => {

    const birdVideo = document.getElementById("birdBgVideo");
    if (!birdVideo) return;

    const source = birdVideo.querySelector("source");
    let videoLoaded = false;
    let gsapInitialized = false;

    const observer = new IntersectionObserver(entries => {
        entries.forEach(entry => {
            if (entry.isIntersecting && !gsapInitialized) {

                gsapInitialized = true;

                if (!videoLoaded) {
                    source.src = source.dataset.src;
                    birdVideo.load();
                    videoLoaded = true;
                }

                gsap.registerPlugin(ScrollTrigger);

                ScrollTrigger.create({
                    trigger: ".bird-page-girl",
                    start: "top 70%",
                    end: "bottom 25%",

                    onEnter: () => birdVideo.play().catch(()=>{}),
                    onEnterBack: () => birdVideo.play().catch(()=>{}),
                    onLeave: () => birdVideo.pause(),
                    onLeaveBack: () => birdVideo.pause(),
                });

                observer.disconnect();
            }
        });
    });

    observer.observe(document.querySelector(".bird-page-girl"));
});
</script>

<div class="bird-page-main-bg hide-on-mobile">
  <img loading="lazy" src="{% static 'img/birdpage-bg1.webp' %}" />
</div>
<div class="bottom-box">
  <div class="bottom-box-col">
    <div class="fadeUpOnScroll bottom-box-icon">
      <img loading="lazy" src="{% static 'img/SubSpecies.webp' %}" />
    </div>
    <div class="fade-section Bottom-Info-title">SUB-SPECIES</div>
    <div class="fade-section Info-detail-text3">
      {{ bird.Bird_Sub_Species_Details }}
    </div>
  </div>
  <div class="bottom-box-col">
    <div class="fadeUpOnScroll bottom-box-icon">
      <img src="{% static 'img/Areaofsight.webp' %}" />
    </div>
    <div class="fade-section Bottom-Info-title">AREA OF SIGHTING</div>
    <div class="fade-section Info-detail-text3">
      {{ bird.Bird_Sighting_Area }}
    </div>
  </div>
  <div class="bottom-box-col">
    <div class="fadeUpOnScroll bottom-box-icon">
      <img src="{% static 'img/Migration.webp' %}" />
    </div>
    <div class="fade-section Bottom-Info-title">MIGRATION</div>
    <div class="fade-section Info-detail-text3">{{ bird.Bird_Migration }}</div>
  </div>
  <div class="bottom-box-col">
    <div class="fadeUpOnScroll bottom-box-icon">
      <img src="{% static 'img/Activetime.webp' %}" />
    </div>
    <div class="fade-section Bottom-Info-title">ACTIVE TIME</div>
    <div class="fade-section Info-detail-text3">
      {{ bird.Bird_Active_Time }}
    </div>
  </div>
</div>
<div class="bottom-box2">
  <div class="bottom-box-col2">
    <div class="fadeUpOnScroll bottom-box-icon">
      <img src="{% static 'img/Plumage.webp' %}" />
    </div>
    <div class="fade-section Bottom-Info-title">PLUMAGE</div>
    <div class="fade-section Info-detail-text4" data-target="PlumageText">
      {{ bird.Bird_Plumange|linebreaks }}
    </div>
    <span class="fade-section read-more-btn">Read more</span>
  </div>
  <div class="bottom-box-col2">
    <div class="fadeUpOnScroll bottom-box-icon">
      <img src="{% static 'img/Diet.webp' %}" />
    </div>
    <div class="fade-section Info-title">DIET & FEEDING BEHAVIOUR</div>
    <div class="fade-section Info-detail-text4" data-target="DietText">
      {{ bird.Bird_Feeding_Behaviour|linebreaks }}
    </div>
    <span class="fade-section read-more-btn">Read more</span>
  </div>
  <div class="bottom-box-col2">
    <div class="fadeUpOnScroll bottom-box-icon">
      <img src="{% static 'img/Habitat.webp' %}" />
    </div>
    <div class="fade-section Bottom-Info-title">HABITAT</div>
    <div class="fade-section Info-detail-text4" data-target="HabitatText">
      {{ bird.Bird_Habitat|linebreaks }}
    </div>
    <span class="fade-section read-more-btn">Read more</span>
  </div>
  <div class="bottom-box-col2">
    <div class="fadeUpOnScroll bottom-box-icon">
      <img src="{% static 'img/Nesting.webp' %}" />
    </div>
    <div class="fade-section Bottom-Info-title">MATING & NESTING</div>

    <div class="fade-section Info-detail-text4" data-target="nestingText">
      {{ bird.Bird_Nesting|linebreaksbr }}
    </div>

    <span class="fade-section read-more-btn">Read more</span>
  </div>
</div>
<script>
  document
    .querySelectorAll(".bottom-box-col2,.bottom-box-col")
    .forEach((box) => {
      box.addEventListener("click", () => {
        box.classList.toggle("open");
      });
    });
</script>
<div class="birdpage-link">
  <a
    class="btn-fill-circle bird-watch-link"
    href="{% url 'Naturetrail' %}"
    aria-label="Bird Watching at Hiranandani"
  >
    UPCOMING NATURE TRAILS
  </a>
</div>
<div class="fadeUpOnScroll bird-bottombox">
  <div class="bird-bootombox-col">
    <div class="doyouknow">
      <div class="fadeUpOnScroll doyouknowimg">
        <img src="{% static 'img/doyouknow.webp' %}" alt="DO YOU KNOW?" />
      </div>
      <div class="doyouknow-text">
        <div class="fade-section earthchallenge-text">DO YOU KNOW?</div>
        <div class="fade-section doyouknow-detail">
          {{ bird.Bird_Fun_Facts }}
        </div>
      </div>
    </div>
    <div class="bird-bootombox-border hide-on-tab-mobile">
      <img src="{% static 'img/Border.png' %}" />
    </div>
  </div>
  <div class="bird-bootombox-border">
    <img src="{% static 'img/Border.png' %}" />
  </div>
  <div class="bird-bootombox-col">
    <div class="doyouknow">
      <div class="fadeUpOnScroll doyouknowimg">
        <img src="{% static 'img/Q&A_1.webp' %}" alt="DO YOU KNOW?" />
      </div>
      <div class="doyouknow-text1">
        <div class="fade-section earthchallenge-text">EARTH CHALLENGE</div>

        <div class="fade-section doyouknow-detail">
          {{ bird.Bird_Quiz_Question }}

          <div class="radio-container">
            <label>
              <input type="radio" name="mcq" value="A" />
              <span class="custom-radio"></span>
              {{ bird.Bird_Quiz_OptionA }}
            </label>

            <label>
              <input type="radio" name="mcq" value="B" />
              <span class="custom-radio"></span>
              {{ bird.Bird_Quiz_OptionB }}
            </label>

            <label>
              <input type="radio" name="mcq" value="C" />
              <span class="custom-radio"></span>
              {{ bird.Bird_Quiz_OptionC }}
            </label>

            <label>
              <input type="radio" name="mcq" value="D" />
              <span class="custom-radio"></span>
              {{ bird.Bird_Quiz_OptionD }}
            </label>
          </div>

          <button id="mcq-submit" class="mcq-submit" disabled>SUBMIT</button>
        </div>

        <!-- âœ… Correct animation -->
        <video
          id="mcq-correct-video"
          class="mcq-video"
          src="{% static 'video/correct.mp4' %}"
          playsinline
          muted
  preload="auto"
        ></video>

        <!-- âŒ Wrong animation -->
        <video
          id="mcq-wrong-video"
          class="mcq-video"
          src="{% static 'video/Wrong.mp4' %}"
          playsinline
          muted
  preload="auto"
        ></video>
      </div>
    </div>
    <div class="bird-bootombox-border hide-on-tab-mobile">
      <img src="{% static 'img/Border.png' %}" />
    </div>
  </div>
  <div class="bird-bootombox-border">
    <img src="{% static 'img/Border.png' %}" />
  </div>
</div>
<div data-page-music="{% static 'audio/Birdpage.mp3' %}"></div>

<script>
  const video = document.getElementById("birdVideo");

  video.addEventListener("click", () => {
    if (video.paused) {
      video.play();
    } else {
      video.pause();
    }
  });
</script>
<script>
  document.addEventListener("DOMContentLoaded", () => {
    document.querySelectorAll(".bottom-box-col2").forEach((block) => {
      const textDiv = block.querySelector(".Info-detail-text4");
      const btn = block.querySelector(".read-more-btn");

      if (!textDiv || !btn) return;

      // Get computed styles
      const style = window.getComputedStyle(textDiv);
      const lineHeight = parseFloat(style.lineHeight);

      if (!lineHeight) return;

      // Calculate number of lines
      const totalLines = Math.round(textDiv.scrollHeight / lineHeight);

      // Hide button if not needed
      if (totalLines <= 6) {
        btn.style.display = "none";
        return;
      }

      // Toggle expand / collapse
      btn.addEventListener("click", () => {
        const expanded = textDiv.classList.toggle("expanded");
        btn.textContent = expanded ? "Close" : "Read more";
      });
    });
  });
</script>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const containers = document.querySelectorAll(".Info-detail-text2");

    containers.forEach((container) => {
      const trigger = container.querySelector(".iucn-trigger");
      const closeBtn = container.querySelector(".iucn-close");
      const popup = container.querySelector(".iucn-popup");

      if (trigger) {
        trigger.addEventListener("click", function (e) {
          e.stopPropagation();

          // Close other popups
          containers.forEach((c) => c.classList.remove("active"));

          // Open this one
          container.classList.add("active");
        });
      }

      if (closeBtn) {
        closeBtn.addEventListener("click", function (e) {
          e.stopPropagation();
          container.classList.remove("active");
        });
      }

      // Prevent clicks inside popup from closing it
      if (popup) {
        popup.addEventListener("click", function (e) {
          e.stopPropagation();
        });
      }
    });

    // âœ… Clicking anywhere outside closes all
    document.addEventListener("click", function () {
      containers.forEach((c) => c.classList.remove("active"));
    });
  });
</script>

<script src="https://unpkg.com/gsap@3/dist/gsap.min.js"></script>
<script src="https://unpkg.com/gsap@3/dist/ScrollTrigger.min.js"></script>

<script>
  /* ---------------------------------------------------
   HIDE PAGE UNTIL GSAP IS READY
--------------------------------------------------- */
  document.documentElement.classList.add("loading");

  document.addEventListener("DOMContentLoaded", () => {
    gsap.registerPlugin(ScrollTrigger);

    requestAnimationFrame(() => {
      // Reveal page
      gsap.set("body", { visibility: "visible" });
      document.documentElement.classList.remove("loading");

      /* ---------------------------------------------------
       MASTER TIMELINE
    --------------------------------------------------- */
      const master = gsap.timeline({
        defaults: { ease: "power3.out" },
      });

      /* STEP 1 â€” TEXT SLIDE UP */
      master.fromTo(
        ".inner2",
        { yPercent: 100, opacity: 0 },
        { yPercent: 0, opacity: 1, duration: 0.6 },
      );

      /* STEP 2 â€” BOX FADE INS */
      master
        .fromTo(
          ".Scientific_name",
          { opacity: 0 },
          { opacity: 1, duration: 0.6 },
          "-=0.3",
        )
        .fromTo(
          ".Other_names",
          { opacity: 0 },
          { opacity: 1, duration: 0.6 },
          "<",
        )

        .fromTo(
          ".Info-titles .Info-title",
          { opacity: 0 },
          { opacity: 1, y: 0, duration: 0.6, stagger: 0.15 },
          0.6,
        )

        .fromTo(
          ".Info-details .Info-detail",
          { opacity: 0 },
          { opacity: 1, y: 0, duration: 0.6, stagger: 0.15 },
          0.6,
        )

        .fromTo(
          ".Info-details-text .Info-detail-text",
          { opacity: 0 },
          { opacity: 1, y: 0, duration: 0.6, stagger: 0.15 },
          0.6,
        )

        .fromTo(
          ".Birdpage-secondbox_1 .Info-title",
          { opacity: 0 },
          { opacity: 1, duration: 0.6, stagger: 0.3 },
          0.6,
        )

        .fromTo(
          ".Info-detail-text2",
          { opacity: 0 },
          { opacity: 1, y: 0, duration: 0.6, stagger: 0.15 },
          0.6,
        )

        .fromTo(
          ".Info-detail-text6",
          { opacity: 0 },
          { opacity: 1, y: 0, duration: 0.6, stagger: 0.15 },
          0.9,
        )

        .fromTo(
          ".bird-map",
          { opacity: 0 },
          { opacity: 1, duration: 0.6, stagger: 0.15 },
          0.6,
        )

        .fromTo(
          ".birdanimationbox",
          { opacity: 0, y: 40, scale: 0.7 },
          { opacity: 1, y: 0, scale: 1, duration: 0.6, ease: "back.out(2.5)" },
          0.7,
        )

        .fromTo(
          ".conservation-svg",
          { opacity: 0, scale: 0.9 },
          { opacity: 1, duration: 0.6 },
          0.9,
        )

        .fromTo(
          ".icon",
          { opacity: 0, scale: 0.9 },
          { opacity: 1, duration: 0.6, stagger: 0.15 },
          0.9,
        )

        .fromTo(
          ".media-head",
          { opacity: 0, scale: 0.9 },
          { opacity: 1, duration: 0.6 },
          0.9,
        )

        .fromTo(
          ".bird-page-main-bg",
          { opacity: 0, y: 50 },
          { opacity: 1, y: 0, duration: 0.6 },
          0.9,
        );

      /* ---------------------------------------------------
       SCROLL ANIMATIONS
    --------------------------------------------------- */
      gsap.utils.toArray(".reveal").forEach((el) => {
        gsap.from(el, {
          opacity: 0,
          scale: 0.95,
          duration: 1.4,
          ease: "expo.out",
          scrollTrigger: {
            trigger: el,
            start: "top 85%",
            end: "top 30%",
            toggleActions: "play none none none",
            once: true,
          },
        });
      });

ScrollTrigger.batch(".fade-section", {
  start: "top 85%",
  once: true,

  onEnter: (batch) => {
    gsap.to(batch, {
      opacity: 1,
      y: 0,
      duration: 0.6,
      ease: "power3.out",
      stagger: 0.15,
    });
  }
});

      gsap.utils.toArray(".btn-fill-circle").forEach((btn) => {
        gsap
          .timeline({
            scrollTrigger: {
              trigger: btn,
              start: "top 85%",
              end: "top 30%",
              toggleActions: "play none none none",
              once: true,
            },
          })
          .fromTo(
            btn,
            { "--circle": 0 },
            { "--circle": 1.2, duration: 0.7, ease: "power2.out" },
          );
      });
ScrollTrigger.batch(".fadeUpOnScroll", {
  start: "top 85%",
  once: true,

  onEnter: (batch) => {
    gsap.to(batch, {
      opacity: 1,
      y: 0,
      visibility: "visible",
      duration: 0.6,
      ease: "power3.out",
      stagger: 0.15,
    });
  }
});
    });
  });
</script>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const trigger = document.querySelector(".bird-audio-trigger");
    const audio = document.getElementById("birdCallAudio");
    const video = document.querySelector(".bird-audio-video");

    if (!trigger || !audio || !video) return;

    let unlocked = false;
    let isPlaying = false;

    /* ðŸ”“ Unlock audio (browser autoplay policy) */
    function unlockAudio() {
      if (unlocked) return;

      audio.volume = 0.9;
      audio
        .play()
        .then(() => {
          audio.pause();
          audio.currentTime = 0;
          unlocked = true;
        })
        .catch(() => {});

      document.removeEventListener("pointerdown", unlockAudio, true);
    }
    document.addEventListener("pointerdown", unlockAudio, true);

    /* â¹ HARD STOP (audio + animation) */
    function hardStopBirdMedia() {
      isPlaying = false;
      trigger.classList.remove("is-playing");

      // Stop audio
      audio.pause();
      audio.currentTime = 0;

      // Stop animation video (DO NOT call load)
      video.pause();
      video.currentTime = 0;
      video.removeAttribute("loop");
    }

    /* â–¶ï¸ / â¸ Toggle play */
    trigger.addEventListener("click", () => {
      if (!unlocked) return;

      if (!isPlaying) {
        isPlaying = true;
        trigger.classList.add("is-playing");

        video.setAttribute("loop", "");
        audio.play().catch(() => {});
        video.play().catch(() => {});
      } else {
        hardStopBirdMedia();
      }
    });

    /* â¹ When audio ends */
    audio.addEventListener("ended", hardStopBirdMedia);

    /* ðŸ‘€ Stop if trigger goes off screen */
    const observer = new IntersectionObserver(
      ([entry]) => {
        if (!entry.isIntersecting && isPlaying) {
          hardStopBirdMedia();
        }
      },
      { threshold: 0.2 },
    );
    observer.observe(trigger);

    /* ðŸšª STOP immediately when navigating to gallery pages */
    document.querySelectorAll('a[href*="bird_gallery"]').forEach((link) => {
      link.addEventListener("pointerdown", hardStopBirdMedia, true);
      link.addEventListener("click", hardStopBirdMedia, true);
    });

    /* ðŸš¨ STOP on page navigation / tab switch */
    window.addEventListener("beforeunload", hardStopBirdMedia);
    document.addEventListener("visibilitychange", () => {
      if (document.hidden) {
        hardStopBirdMedia();
      }
    });
  });
</script>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const bg = document.querySelector(".Bird-image");
    if (!bg) return;

    gsap.fromTo(
      bg,
      { yPercent: 5 },
      {
        yPercent: -30,
        ease: "none",
        scrollTrigger: {
          start: 0,
          end: () => ScrollTrigger.maxScroll(window),
          scrub: true,
          invalidateOnRefresh: true,
        },
      },
    );
  });
</script>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const submitBtn = document.getElementById("mcq-submit");
    const correctAnswer = "{{ bird.Bird_Quiz_Correct }}";

    const correctVideo = document.getElementById("mcq-correct-video");
    const wrongVideo = document.getElementById("mcq-wrong-video");
    const radios = document.querySelectorAll('input[name="mcq"]');

    // Enable submit button as soon as any option is picked
    radios.forEach((radio) => {
      radio.addEventListener("change", () => {
        submitBtn.disabled = false;
      });
    });

    submitBtn.addEventListener("click", () => {
      const selected = document.querySelector('input[name="mcq"]:checked');
      if (!selected) return;

      // Check answer
      const isCorrect = selected.value === correctAnswer;

      if (isCorrect) {
        playVideo(correctVideo);
      } else {
        playVideo(wrongVideo);
      }

      // Note: We do NOT disable radios or the button here,
      // allowing the user to select and submit again immediately.
    });

    function playVideo(videoToPlay) {
      // Reset and hide both videos first
      [correctVideo, wrongVideo].forEach((v) => {
        v.pause();
        v.currentTime = 0;
        v.classList.remove("show");
      });

      // Show and play the requested video
      videoToPlay.classList.add("show");
      videoToPlay.play().catch((e) => console.log("Autoplay prevented:", e));
    }
  });
</script>
<script>
  document.addEventListener("DOMContentLoaded", () => {
    const bgVideo = document.getElementById("birdBgVideo");
    if (!bgVideo) return;

    function resumeBgVideo() {
      // ðŸš« Don't autoplay if ScrollTrigger is controlling it
      if (!ScrollTrigger) return;

      const trigger = ScrollTrigger.getById("birdBgTrigger");
      if (trigger && trigger.isActive) {
        bgVideo.play().catch(() => {});
      }
    }

    window.addEventListener("pageshow", resumeBgVideo);
  });
</script>

{% endblock %}
